<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HiCMA: testing/testing_zposv.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HiCMA
   </div>
   <div id="projectbrief">Hierarchical Computations on Manycore Architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('testing__zposv_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">testing_zposv.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="testing__zposv_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * file testing_zposv.c</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * MORSE testing routines</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * MORSE is a software package provided by Univ. of Tennessee,</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * Univ. of California Berkeley and Univ. of Colorado Denver</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * version 2.5.0</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * comment This file has been automatically generated</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *         from Plasma 2.5.0 for MORSE 1.0.0</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * author Bilel Hadri, Hatem Ltaief</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * author Mathieu Faverge</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * author Emmanuel Agullo</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * author Cedric Castagnede</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * date 2010-11-15</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * precisions normal z -&gt; c d s</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="timing_8h.html">timing.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hicma__constants_8h.html">hicma_constants.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hicma__struct_8h.html">hicma_struct.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hicma__z_8h.html">hicma_z.h</a>&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hicma_8h.html">hicma.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;hicma_common.h&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;auxcompute_z.h&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;auxdescutil.h&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// zgytlr uses starsh in MPI mode.</span></div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a44c4b4ac7cd71c503b133733604ad3ad">   55</a></span>&#160;STARSH_blrf *<a class="code" href="testing__zposv_8c.html#a44c4b4ac7cd71c503b133733604ad3ad">mpiF</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#ae303075f66206b33ae8872b02a156749">   57</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="testing__zposv_8c.html#ae303075f66206b33ae8872b02a156749">datebuf</a>[128];</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#ae2281da6157495d69406c35f69a61f9f">   58</a></span>&#160;time_t <a class="code" href="testing__zposv_8c.html#ae2281da6157495d69406c35f69a61f9f">timer</a>;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#aa85c9eab3bb20fb73495fb9d1928ba82">   59</a></span>&#160;<span class="keyword">struct </span>tm* <a class="code" href="testing__zposv_8c.html#aa85c9eab3bb20fb73495fb9d1928ba82">tm_info</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#abdeec1578acd87ea1bd3331fc790184f">   61</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#abdeec1578acd87ea1bd3331fc790184f">store_only_diagonal_tiles</a> = 0;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#aa6297329aab26a48806350a4b8fcb0c1">   62</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#aa6297329aab26a48806350a4b8fcb0c1">global_check</a> = 0;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a0511e461ff0eecd8438a9396907a6cf7">   63</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a0511e461ff0eecd8438a9396907a6cf7">global_always_fixed_rank</a> = 0;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a9a02d72544ae226c3517f7bcfd6d8cfb">   64</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a9a02d72544ae226c3517f7bcfd6d8cfb">global_fixed_rank</a> = 0;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a9f5eb02dc0de8dfb68423b6bf1584d4f">   65</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a9f5eb02dc0de8dfb68423b6bf1584d4f">global_omit_computation</a> = 1;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#aeb23e3045f3c24373c05b3fa07ea56ec">   66</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#aeb23e3045f3c24373c05b3fa07ea56ec">num_mpi_ranks</a>;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a0db6b4e1bb0df6828e8db32f80fe5188">   67</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a0db6b4e1bb0df6828e8db32f80fe5188">run_potrf</a> = 1;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a7b03aa5d40a76877504a546ca74e7e5e">   68</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a7b03aa5d40a76877504a546ca74e7e5e">diag_nrows</a> = 0;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#ac917522ad05f6f21b5cc38fe99ab4de7">   69</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#ac917522ad05f6f21b5cc38fe99ab4de7">main_print_index</a> = 0;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a93f13d2deb70a9588f4db51c4a4e1cea">   70</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a93f13d2deb70a9588f4db51c4a4e1cea">print_index</a> = 0;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#ac7db2505fed4fcb84e94a6225ba1fe4a">   71</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#ac7db2505fed4fcb84e94a6225ba1fe4a">print_index_end</a> = 0;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a8d256ee0e918b448d34a31918dedbd83">   72</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a8d256ee0e918b448d34a31918dedbd83">main_print_mat</a> = 0;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a657cb599f5adb6ac9b0fe93c811417cf">   73</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a657cb599f5adb6ac9b0fe93c811417cf">print_mat</a> = 0;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a43a9b9179b6dbe0abf84e1a4545f9ff0">   74</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a43a9b9179b6dbe0abf84e1a4545f9ff0">use_scratch</a> = 1; <span class="comment">// Use scratch memory provided by starpu</span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#aa6e67ccd4b03d37bcc8a0dd2550252b4">   75</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#aa6e67ccd4b03d37bcc8a0dd2550252b4">calc_rank_stat</a> = 1;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">   76</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a> = 0;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &lt;sys/time.h&gt;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &lt;morse.h&gt;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="testing__zauxiliary_8h.html">testing_zauxiliary.h</a>&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04e">   90</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04e">blas_order_type</a> {</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea635ab08ac28ae417e25c0d163c40f19d">   91</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea635ab08ac28ae417e25c0d163c40f19d">blas_rowmajor</a> = 101,</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">   92</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a> = 102 };</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aa">   94</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aa">blas_cmach_type</a> {</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa450c812108b1c81a0f6ef65c51f64d7b">   95</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa450c812108b1c81a0f6ef65c51f64d7b">blas_base</a>      = 151,</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa16a1c297dab1551cf40bbe5210395f10">   96</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa16a1c297dab1551cf40bbe5210395f10">blas_t</a>         = 152,</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa3d5fea2fad72607b2368ace39fa89280">   97</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa3d5fea2fad72607b2368ace39fa89280">blas_rnd</a>       = 153,</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa640085acde3bcb1c78c42e9b5838c714">   98</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa640085acde3bcb1c78c42e9b5838c714">blas_ieee</a>      = 154,</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaad93796f5d1a8bc7bb4d9512dc312e8df">   99</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaad93796f5d1a8bc7bb4d9512dc312e8df">blas_emin</a>      = 155,</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa26e73a26ce9e06149fff858bdfb5f363">  100</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa26e73a26ce9e06149fff858bdfb5f363">blas_emax</a>      = 156,</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa3e407f69dd9a70e04e91602a3d76ae4a">  101</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa3e407f69dd9a70e04e91602a3d76ae4a">blas_eps</a>       = 157,</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaaadf329e788494c80e522348ef1210d9f">  102</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaaadf329e788494c80e522348ef1210d9f">blas_prec</a>      = 158,</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa4159c63ae4ee2275d8e09d02ecb85428">  103</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa4159c63ae4ee2275d8e09d02ecb85428">blas_underflow</a> = 159,</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa51424a153ba5a72b4fb5018732bbaa02">  104</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa51424a153ba5a72b4fb5018732bbaa02">blas_overflow</a>  = 160,</div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa0a3cdfdc2ddd9ce036017d4c57aa941a">  105</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa0a3cdfdc2ddd9ce036017d4c57aa941a">blas_sfmin</a>     = 161};</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952b">  107</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952b">blas_norm_type</a> {</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab661151b14ab3c58c0b3d335528db250">  108</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab661151b14ab3c58c0b3d335528db250">blas_one_norm</a>       = 171,</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba6f826b18a3a197b97b228961fdab47b3">  109</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba6f826b18a3a197b97b228961fdab47b3">blas_real_one_norm</a>  = 172,</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba57c558d28842a2b7b90df3a796fde77e">  110</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba57c558d28842a2b7b90df3a796fde77e">blas_two_norm</a>       = 173,</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba607f3142e766379f65fecd8964e9a8ed">  111</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba607f3142e766379f65fecd8964e9a8ed">blas_frobenius_norm</a> = 174,</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">  112</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a>       = 175,</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba1ff3a55280960c17e59d37500ab4eec5">  113</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba1ff3a55280960c17e59d37500ab4eec5">blas_real_inf_norm</a>  = 176,</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba6a806e7014a17f2b175780210e43d0cf">  114</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba6a806e7014a17f2b175780210e43d0cf">blas_max_norm</a>       = 177,</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bae48280621b0adfec78d7a180c1026953">  115</a></span>&#160;            <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bae48280621b0adfec78d7a180c1026953">blas_real_max_norm</a>  = 178 };</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;BLAS_error(<span class="keywordtype">char</span> *rname, <span class="keywordtype">int</span> err, <span class="keywordtype">int</span> val, <span class="keywordtype">int</span> x) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  fprintf( stderr, <span class="stringliteral">&quot;%s %d %d %d\n&quot;</span>, rname, err, val, x );</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  abort();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keyword">static</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;BLAS_dge_norm(<span class="keyword">enum</span> <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04e">blas_order_type</a> order, <span class="keyword">enum</span> <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952b">blas_norm_type</a> <a class="code" href="testing__zauxiliary_8c.html#ae211b83247d41c3a457052ed883e3e1c">norm</a>,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span> *a, <span class="keywordtype">int</span> lda, <span class="keywordtype">double</span> *res) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">int</span> i, j; <span class="keywordtype">float</span> anorm, v;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">char</span> rname[] = <span class="stringliteral">&quot;BLAS_dge_norm&quot;</span>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> (order != <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a>) BLAS_error( rname, -1, order, 0 );</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="testing__zauxiliary_8c.html#ae211b83247d41c3a457052ed883e3e1c">norm</a> == <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba607f3142e766379f65fecd8964e9a8ed">blas_frobenius_norm</a>) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    anorm = 0.0f;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">for</span> (j = n; j; --j) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">for</span> (i = m; i; --i) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        v = a[0];</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        anorm += v * v;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        a++;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      a += lda - m;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    anorm = sqrt( anorm );</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="testing__zauxiliary_8c.html#ae211b83247d41c3a457052ed883e3e1c">norm</a> == <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a>) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    anorm = 0.0f;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; m; ++i) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      v = 0.0f;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; n; ++j) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        v += cabs( a[i + j * lda] );</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">if</span> (v &gt; anorm)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        anorm = v;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    BLAS_error( rname, -2, <a class="code" href="testing__zauxiliary_8c.html#ae211b83247d41c3a457052ed883e3e1c">norm</a>, 0 );</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">if</span> (res) *res = anorm;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keyword">static</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">double</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;BLAS_dpow_di(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> n) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordtype">double</span> rv = 1.0;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">if</span> (n &lt; 0) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    n = -n;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    x = 1.0 / x;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">for</span> (; n; n &gt;&gt;= 1, x *= x) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (n &amp; 1)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      rv *= x;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">return</span> rv;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keyword">static</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordtype">double</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;BLAS_dfpinfo(<span class="keyword">enum</span> <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aa">blas_cmach_type</a> cmach) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">double</span> eps = 1.0, r = 1.0, o = 1.0, b = 2.0;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordtype">int</span> t = 53, l = 1024, m = -1021;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">char</span> rname[] = <span class="stringliteral">&quot;BLAS_dfpinfo&quot;</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">if</span> ((<span class="keyword">sizeof</span> eps) == <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    t = 24;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    l = 128;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    m = -125;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    t = 53;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    l = 1024;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    m = -1021;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">/* for (i = 0; i &lt; t; ++i) eps *= half; */</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  eps = BLAS_dpow_di( b, -t );</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">/* for (i = 0; i &gt;= m; --i) r *= half; */</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  r = BLAS_dpow_di( b, m-1 );</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  o -= eps;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">/* for (i = 0; i &lt; l; ++i) o *= b; */</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  o = (o * BLAS_dpow_di( b, l-1 )) * b;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">switch</span> (cmach) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa3e407f69dd9a70e04e91602a3d76ae4a">blas_eps</a>: <span class="keywordflow">return</span> eps;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa0a3cdfdc2ddd9ce036017d4c57aa941a">blas_sfmin</a>: <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      BLAS_error( rname, -1, cmach, 0 );</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a8425a9dfb0b29dd7a3b1ec27bb670b7b">  215</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a8425a9dfb0b29dd7a3b1ec27bb670b7b">testing_dtrsmd</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv){}<span class="comment">//FIXME Use CMakeLists from Chameleon</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> check_factorization(<span class="keywordtype">int</span>, <span class="keywordtype">double</span>*, <span class="keywordtype">double</span>*, <span class="keywordtype">int</span>, <span class="keywordtype">int</span> , <span class="keywordtype">double</span>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> check_solution(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">double</span>*, <span class="keywordtype">int</span>, <span class="keywordtype">double</span>*, <span class="keywordtype">double</span>*, <span class="keywordtype">int</span>, <span class="keywordtype">double</span>);</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="testing__zposv_8c.html#a28d31db4990daf0197cb0ac24c95ccd5">  228</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="testing__zposv_8c.html#a28d31db4990daf0197cb0ac24c95ccd5">testing_dposv</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;{</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="hicma__init_8c.html#aaa82fe254c96bfd780cb79ed033cff0f">HICMA_init</a>();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">//HICMA_set_print_index();</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">//HICMA_set_print_index_end();</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">//HICMA_unset_print_index_end();</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">/*HICMA_set_use_fast_hcore_zgemm();*/</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    </div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">int</span> hres = 0;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">/*int nbnode = 0;*/</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">/*MORSE_Comm_size( &amp;nbnode );*/</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">/*printf(&quot;Myrank:%d nbnode:%d\n&quot;, MORSE_My_Mpi_Rank(), nbnode);*/</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">/*fflush( stdout );*/</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">/* Check for number of arguments*/</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">if</span> (argc != 12){</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="testing__zauxiliary_8h.html#a62447c1589cbae34e393d90ef58fbae0">USAGE</a>(<span class="stringliteral">&quot;POSV&quot;</span>, <span class="stringliteral">&quot;N LDA NRHS LDB&quot;</span>,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              <span class="stringliteral">&quot;   - N    : the size of the matrix\n&quot;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;              <span class="stringliteral">&quot;   - LDA  : leading dimension of the matrix A\n&quot;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;              <span class="stringliteral">&quot;   - NRHS : number of RHS\n&quot;</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;              <span class="stringliteral">&quot;   - LDB  : leading dimension of the RHS B\n&quot;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;              <span class="stringliteral">&quot;   - NB   : Block size\n&quot;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;              <span class="stringliteral">&quot;   - acc  : Fixed accuracy threshold\n&quot;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;              <span class="stringliteral">&quot;   - rk   : Fixed rank threshold\n&quot;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;              <span class="stringliteral">&quot;   - maxrank   : maxrank for U and V storage\n&quot;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;              <span class="stringliteral">&quot;   - compmaxrank   : maxrank for starsh and buffers\n&quot;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;              <span class="stringliteral">&quot;   - P   : num procs in row dim\n&quot;</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;              <span class="stringliteral">&quot;   - Q   : num procs in col dim\n&quot;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;              <span class="stringliteral">&quot;   - check   : {0,1}\n&quot;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;              );</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">int</span> N     = atoi(argv[0]);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">int</span> LDA   = atoi(argv[1]);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">int</span> NRHS  = atoi(argv[2]);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">int</span> LDB   = atoi(argv[3]);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">int</span> NB    = atoi(argv[4]);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">double</span> fixedacc    = atof(argv[5]);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">int</span> fixedrank    = atoi(argv[6]);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">int</span> maxrank    = atoi(argv[7]);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">int</span> comp_maxrank = atoi(argv[8]);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordtype">int</span> P = atoi(argv[9]);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">int</span> Q = atoi(argv[10]);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a> = atoi(argv[11]);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">double</span> eps;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">int</span> info_solution, info_factorization;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">int</span> trans1, trans2;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        printf(<span class="stringliteral">&quot;A: %d-by-%d LD:%d\n&quot;</span>, N, N, LDA);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        printf(<span class="stringliteral">&quot;B: %d-by-%d LD:%d\n&quot;</span>, N, NRHS, LDB);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        printf(<span class="stringliteral">&quot;NB: %d  fixedrank: %d  fixedacc:%.1e\n&quot;</span>, NB ,fixedrank, fixedacc);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        printf(<span class="stringliteral">&quot;MaxrankUV: %d  MaxrankBuffers: %d\n&quot;</span>, maxrank, comp_maxrank);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">double</span> *A1   = NULL;  </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">double</span> *A2   = NULL; </div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">double</span> *B1   = NULL; </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">double</span> *B2   = NULL; </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        A1   = (<span class="keywordtype">double</span> *)malloc(LDA*N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        A2   = (<span class="keywordtype">double</span> *)malloc(LDA*N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        B1   = (<span class="keywordtype">double</span> *)malloc(LDB*NRHS*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        B2   = (<span class="keywordtype">double</span> *)malloc(LDB*NRHS*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">/* Check if unable to allocate memory */</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span> ((!A1)||(!A2)||(!B1)||(!B2)){</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            printf(<span class="stringliteral">&quot;Out of Memory \n &quot;</span>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">return</span> -2;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    eps = BLAS_dfpinfo( <a class="code" href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa3e407f69dd9a70e04e91602a3d76ae4a">blas_eps</a> );</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a> = MorseUpper;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a> = MorseLower; <span class="comment">//to comply with current HICMA_dpotrf</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    trans1 = <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a> == MorseUpper ? MorseTrans : MorseNoTrans;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    trans2 = <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a> == MorseUpper ? MorseNoTrans : MorseTrans;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">/*-------------------------------------------------------------</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    *  TESTING ZPOTRF + ZPTRSM + ZTRSM</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">/* Initialize A1 and A2 for Symmetric Positif Matrix */</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">/*MORSE_dplgsy( N, MorseUpperLower, N, A1, LDA, 51 );*/</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">/*MORSE_dlacpy( MorseUpperLower, N, N, A1, LDA, A2, LDA );*/</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">/* Initialize B1 and B2 */</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">/*MORSE_dplrnt( N, NRHS, B1, LDB, 371 );*/</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">/*MORSE_dlacpy( MorseUpperLower, N, NRHS, B1, LDB, B2, LDB );*/</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">/*MORSE_dpotrf(uplo, N, A2, LDA);*/</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">/*MORSE_dtrsm(MorseLeft, uplo, trans1, MorseNonUnit,*/</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                 <span class="comment">/*N, NRHS, 1.0, A2, LDA, B2, LDB);*/</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">/*MORSE_dtrsm(MorseLeft, uplo, trans2, MorseNonUnit,*/</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                 <span class="comment">/*N, NRHS, 1.0, A2, LDA, B2, LDB);*/</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// this paramater enables storing only diagonal tiles in a tall and skinny matrix</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="testing__zposv_8c.html#abdeec1578acd87ea1bd3331fc790184f">store_only_diagonal_tiles</a> = 1;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">//eps = fixedacc/10;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">int</span> NBxMaxrank = NB * maxrank;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> NT = N/NB;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">int</span> NTxMaxrank = NT * maxrank;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">int</span> NBxNB = NB * NB;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordtype">int</span> NBxNRHS = NB * NRHS;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">int</span> status;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="structhicma__problem__s.html">HICMA_problem_t</a> hicma_problem;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">int</span> probtype;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">char</span> sym;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">double</span> ddecay;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">/*BEGIN                AAAAAAAAAAAAAAAAAAAAAAAA                        */</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    MORSE_desc_t *descAUV = NULL;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    status = MORSE_Desc_Create(&amp;descAUV, NULL, MorseRealDouble, NB, maxrank*2, NBxMaxrank*2, LDA,  NTxMaxrank*2, 0, 0, N, NTxMaxrank*2, P, Q);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span>(status != MORSE_SUCCESS){ <span class="keywordflow">return</span> status; } </div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    MORSE_desc_t *descAD = NULL;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    status = MORSE_Desc_Create(&amp;descAD, NULL, MorseRealDouble, NB, NB, NBxNB, LDA,  NB, 0, 0, N, NB, P, Q); </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span>(status != MORSE_SUCCESS){ <span class="keywordflow">return</span> status; } </div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    MORSE_desc_t *descArk = NULL;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    status = MORSE_Desc_Create(&amp;descArk, NULL, MorseRealDouble, 1, 1, 1, NT, NT, 0, 0, NT, NT, P, Q);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span>(status != MORSE_SUCCESS){ <span class="keywordflow">return</span> status; } </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    MORSE_dlaset_Tile(MorseLower, 0.0, NB, descArk);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    MORSE_desc_t *descAdense = NULL;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        status = MORSE_Desc_Create(&amp;descAdense, NULL, MorseRealDouble, NB, NB, NBxNB, LDA, N, 0, 0, N, N, P, Q);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">if</span>(status != MORSE_SUCCESS){ <span class="keywordflow">return</span> status; } </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    probtype = <a class="code" href="hicma__constants_8h.html#a0ac6248f461a4a6216198380ae040de4">HICMA_STARSH_PROB_SS</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    sym = <span class="charliteral">&#39;S&#39;</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a277a26c7aa8ea35fd91e8380a4975276">ndim</a> = 2;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// Correlation length</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a28b0fc4cfeed43d574b4a509bbb677ec">beta</a>  = 0.1;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// Smoothing parameter for Matern kernel</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a069c64f1bdeb11b98c64cefb9c3c2f8b">nu</a>    = 0.5;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// Shift added to diagonal elements</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a8d78cccef2bdf229604009ebcea0af55">noise</a> = 1.e-4; <span class="comment">//not enough for matrices larger than 600K</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a8d78cccef2bdf229604009ebcea0af55">noise</a> = 5.e-4; <span class="comment">//works for 640K but does not work for 10M</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a8d78cccef2bdf229604009ebcea0af55">noise</a> = 1.e-2; <span class="comment">//</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <span class="comment">// probtype = HICMA_STARSH_PROB_EDSIN;</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a8f3435c8c683d2a95517ae7213d3b9f1">wave_k</a> = 20;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a20f9468f7d97d90af57a34ca8dd31f34">diag</a> = N;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    HICMA_zgenerate_problem(probtype, sym, ddecay, N, NB, NT, NT, &amp;hicma_problem);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="zhagdm_8c.html#a8ca1f21ad6ed9a1efaa328076be8f383">HICMA_zhagdm_Tile</a>(MorseLower, descAdense);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keyword">struct </span>timeval tvalBefore, tvalAfter;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    gettimeofday (&amp;tvalBefore, NULL);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="zhagdm_8c.html#af7fb9e553cc44d524879590bca083e3a">HICMA_zhagdmdiag_Tile</a>(MorseUpperLower, descAD);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    gettimeofday (&amp;tvalAfter, NULL);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">double</span> tgad = (tvalAfter.tv_sec - tvalBefore.tv_sec)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                 +(tvalAfter.tv_usec - tvalBefore.tv_usec)/1000000.0;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    gettimeofday (&amp;tvalBefore, NULL);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="zhagcm_8c.html#acb781bd1e4c1392280b0b31b3a5b8364">HICMA_zhagcm_Tile</a>(MorseLower, descAUV, descArk, N, N, NB, NB, maxrank, fixedacc);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    gettimeofday (&amp;tvalAfter, NULL);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">double</span> tgauv = (tvalAfter.tv_sec - tvalBefore.tv_sec)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                 +(tvalAfter.tv_usec - tvalBefore.tv_usec)/1000000.0; <span class="comment">//FIXME implement the function</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#aa6e67ccd4b03d37bcc8a0dd2550252b4">calc_rank_stat</a>){ <span class="comment">// print initial ranks of A</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descArk, Ark_initial, 1, <span class="keywordtype">double</span>, NT, NT );</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">if</span>(MORSE_My_Mpi_Rank()==0){</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <a class="code" href="structhicma__stat__s.html">HICMA_stat_t</a> hicma_statrk_initial;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            zget_stat(MorseLower, Ark_initial, NT, NT, NT,  &amp;hicma_statrk_initial);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            printf(<span class="stringliteral">&quot;------------------------------A initial_ranks:&quot;</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            zprint_stat(hicma_statrk_initial);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            fflush(stderr);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            fflush(stdout);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">double</span> *Aorg = NULL;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descAdense, _Aorg, 1, <span class="keywordtype">double</span>, LDA, N );</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        Aorg = _Aorg;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        {  <span class="comment">// fill upper part of Aorg so the rest of code taken from Chameleon works correctly.</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordtype">int</span> i, j;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="keywordflow">for</span>(j = 0; j &lt; N; j++){</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keywordflow">for</span>(i = 0; i &lt; j; i++){</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    <span class="comment">//Aorg[j*LDA+i] = 0.0;</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    Aorg[j*LDA+i] = Aorg[i*LDA+j];</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    <span class="comment">//           Acham[j*LDA+i] = 0.0;</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">/*END                AAAAAAAAAAAAAAAAAAAAAAAA                        */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">/*BEGIN                BBBBBBBBBBBBBBBBBBBBBBBB                        */</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">int</span> NTB = ceil(NRHS*1.0/NB);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">int</span> NTBxMaxrank = NTB * maxrank;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    MORSE_desc_t *descBUV = NULL;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    status = MORSE_Desc_Create(&amp;descBUV, NULL, MorseRealDouble, NB, maxrank*2, NBxMaxrank*2, LDA, NTBxMaxrank*2, 0, 0, N, NTBxMaxrank*2, P, Q);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span>(status != MORSE_SUCCESS){ <span class="keywordflow">return</span> status; } </div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    MORSE_desc_t *descBrk = NULL;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    status = MORSE_Desc_Create(&amp;descBrk, NULL, MorseRealDouble, 1, 1, 1, NT, NTB, 0, 0, NT, NTB, P, Q); </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span>(status != MORSE_SUCCESS){ <span class="keywordflow">return</span> status; } </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    MORSE_desc_t *descBdense = NULL;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        status = MORSE_Desc_Create(&amp;descBdense, NULL, MorseRealDouble, NB, NB, NBxNB, LDA, NRHS, 0, 0, N, NRHS, P, Q);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">if</span>(status != MORSE_SUCCESS){ <span class="keywordflow">return</span> status; } </div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">/*if randtlr*/</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">//probtype = HICMA_STARSH_PROB_RND;</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    sym = <span class="charliteral">&#39;N&#39;</span>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a8d78cccef2bdf229604009ebcea0af55">noise</a>    = 0.0; <span class="comment">//value added to diagonal</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">//hicma_problem.wave_k = 20;</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    hicma_problem.<a class="code" href="structhicma__problem__s.html#a20f9468f7d97d90af57a34ca8dd31f34">diag</a> = hicma_problem.<a class="code" href="structhicma__problem__s.html#a8f3435c8c683d2a95517ae7213d3b9f1">wave_k</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    ddecay = 1e-2;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">double</span> fixedacc_B = 1e-12;<span class="comment">//fixedacc;</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    fixedacc_B = fixedacc;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    HICMA_zgenerate_problem(probtype, sym, ddecay, N, NB, NT, NT, &amp;hicma_problem);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="testing__zposv_8c.html#a44c4b4ac7cd71c503b133733604ad3ad">mpiF</a> = hicma_problem.<a class="code" href="structhicma__problem__s.html#a39732d3763d08c55546b52cd143a04d5">starsh_format</a>; <span class="comment">// This is assignment will be hidden from user in release</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <a class="code" href="zhagdm_8c.html#a8ca1f21ad6ed9a1efaa328076be8f383">HICMA_zhagdm_Tile</a>(MorseUpperLower, descBdense);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    gettimeofday (&amp;tvalBefore, NULL);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="zhagcm_8c.html#acb781bd1e4c1392280b0b31b3a5b8364">HICMA_zhagcm_Tile</a>(MorseUpperLower, descBUV, descBrk, N, NRHS, NB,  NB, maxrank, fixedacc_B);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    gettimeofday (&amp;tvalAfter, NULL);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">double</span> tgbuv = (tvalAfter.tv_sec - tvalBefore.tv_sec)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                 +(tvalAfter.tv_usec - tvalBefore.tv_usec)/1000000.0;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">//check_same(descBrk, descBrk2, &#39;A&#39;, &#39;A&#39;); //FIXME implement the function</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#aa6e67ccd4b03d37bcc8a0dd2550252b4">calc_rank_stat</a>){ <span class="comment">// print initial ranks</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descBrk, Brk_initial, 1, <span class="keywordtype">double</span>, NT, NTB); </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">if</span>(MORSE_My_Mpi_Rank()==0){</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <a class="code" href="structhicma__stat__s.html">HICMA_stat_t</a> hicma_statrk_initial;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            zget_stat(MorseLower, Brk_initial, NT, NTB, NT,  &amp;hicma_statrk_initial);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            printf(<span class="stringliteral">&quot;------------------------------B initial_ranks:&quot;</span>);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            zprint_stat(hicma_statrk_initial);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            fflush(stderr);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            fflush(stdout);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">double</span> *Borg = NULL;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>){</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descBdense, _Borg, 1, <span class="keywordtype">double</span>, LDA, NRHS ); </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        Borg = _Borg;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="comment">/*END                BBBBBBBBBBBBBBBBBBBBBBBB                        */</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">// Save A</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        MORSE_dlacpy( MorseUpperLower, N, N, Aorg, LDA, A1, LDA );</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        MORSE_dlacpy( MorseUpperLower, N, N, Aorg, LDA, A2, LDA );</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a8d256ee0e918b448d34a31918dedbd83">main_print_mat</a> ){printf(<span class="stringliteral">&quot;Aorg\n&quot;</span>);printmat_format(Aorg,N,N,LDA,1000, 1000, 0);}</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">// Save B</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        MORSE_dlacpy( MorseUpperLower, N, NRHS, Borg, LDA, B1, LDA );</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        MORSE_dlacpy( MorseUpperLower, N, NRHS, Borg, LDA, B2, LDA );</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a8d256ee0e918b448d34a31918dedbd83">main_print_mat</a> ){printf(<span class="stringliteral">&quot;Borg\n&quot;</span>);printmat_format(Borg,N,NRHS,LDB,1000, 1000, 0);}</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        MORSE_dpotrf(<a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, N, A2, LDA);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        MORSE_dtrsm(MorseLeft, <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, trans1, MorseNonUnit,</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                N, NRHS, 1.0, A2, LDA, B2, LDB);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">if</span>(0)cblas_dgemm(CblasColMajor, CblasNoTrans, CblasNoTrans, N, NRHS, N, 1.0, A1, LDA, B2, LDB, 0.0, B1, LDB);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        MORSE_dtrsm(MorseLeft, <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, trans2, MorseNonUnit,</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                N, NRHS, 1.0, A2, LDA, B2, LDB);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    gettimeofday (&amp;tvalBefore, NULL);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="zpotrf_8c.html#a8d8da3e5c0f95aa5c8887d96268d9ffa">HICMA_zpotrf_Tile</a>(MorseLower, descAUV, descAD, descArk, fixedrank, comp_maxrank, fixedacc );</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    gettimeofday (&amp;tvalAfter, NULL);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">double</span> tpotrf = (tvalAfter.tv_sec - tvalBefore.tv_sec)</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                 +(tvalAfter.tv_usec - tvalBefore.tv_usec)/1000000.0;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">double</span> *Ahicma = NULL;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        HICMA_zuncompress(MorseLower, descAUV, descAdense, descArk);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        HICMA_zdiag_vec2mat(descAD, descAdense);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descAdense, _Ahicma, 1, <span class="keywordtype">double</span>, LDA, N );</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        Ahicma = _Ahicma;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#aa6e67ccd4b03d37bcc8a0dd2550252b4">calc_rank_stat</a>){ <span class="comment">// print final ranks of L</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descArk, Ark_initial, 1, <span class="keywordtype">double</span>, NT, NT ); </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">if</span>(MORSE_My_Mpi_Rank()==0){</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <a class="code" href="structhicma__stat__s.html">HICMA_stat_t</a> hicma_statrk_initial;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            zget_stat(MorseLower, Ark_initial, NT, NT, NT,  &amp;hicma_statrk_initial);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            printf(<span class="stringliteral">&quot;------------------------------A final_ranks after HICMA_potrf():&quot;</span>);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            zprint_stat(hicma_statrk_initial);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            fflush(stderr);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            fflush(stdout);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">//Check Chameleon. A1 is original matrix, A2 is L coming from MORSE_dpotrf</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">//info_factorization = check_factorization( N, A1, A2, LDA, uplo, eps);</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">//Check Hicma. Aorg is original matrix, Ahicma is L coming from HICMA_dpotrf</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        info_factorization = check_factorization( N, Aorg, Ahicma, LDA, <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, fixedacc);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">//return info_factorization; </span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="comment">//check if uncompress works well for B</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="comment">/*HICMA_zuncompress(MorseUpperLower, descBUV, descBdense2, descBrk); */</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="comment">/*PASTE_TILE_TO_LAPACK( descBdense2, Bhicma2, 1, double, LDA, N );*/</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">/*MORSE_dtrsm(MorseLeft, uplo, trans1, MorseNonUnit,*/</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="comment">/*N, NRHS, 1.0, A2, LDA, Bhicma2, LDB);*/</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">/*MORSE_dtrsm(MorseLeft, uplo, trans2, MorseNonUnit,*/</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">/*N, NRHS, 1.0, A2, LDA, Bhicma2, LDB);*/</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">/*info_solution = check_solution(N, NRHS, Aorg, LDA, Borg, Bhicma2, LDB, eps);*/</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">/*return 0;*/</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        printf(<span class="stringliteral">&quot;------ TESTS FOR CHAMELEON ZPOTRF + ZTRSM + ZTRSM  ROUTINE -------  \n&quot;</span>);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        printf(<span class="stringliteral">&quot;            Size of the Matrix %d by %d\n&quot;</span>, N, N);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        printf(<span class="stringliteral">&quot; The matrix A is randomly generated for each test.\n&quot;</span>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        printf(<span class="stringliteral">&quot;============\n&quot;</span>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        printf(<span class="stringliteral">&quot; The relative machine precision (eps) is to be %e \n&quot;</span>, eps);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        printf(<span class="stringliteral">&quot; Computational tests pass if scaled residuals are less than 60.\n&quot;</span>);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span>(0)MORSE_dtrsm_Tile(MorseLeft, <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, trans1, MorseNonUnit, 1.0, </div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            descAdense, descBdense);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span>(0)MORSE_dtrsm_Tile(MorseLeft, <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, trans2, MorseNonUnit, 1.0, </div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            descAdense, descBdense);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    gettimeofday (&amp;tvalBefore, NULL);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span>(1)<a class="code" href="ztrsm_8c.html#a2f3bc32948dc5295b53bc442465956ac">HICMA_ztrsm_Tile</a>(MorseLeft, <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, trans1, MorseNonUnit, 1.0, </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            descAUV, </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            descAD, </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            descArk,</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            descBUV, </div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            descBrk, </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            fixedrank, comp_maxrank, fixedacc);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    gettimeofday (&amp;tvalAfter, NULL);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordtype">double</span> ttrsm1 = (tvalAfter.tv_sec - tvalBefore.tv_sec)</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                 +(tvalAfter.tv_usec - tvalBefore.tv_usec)/1000000.0;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#aa6e67ccd4b03d37bcc8a0dd2550252b4">calc_rank_stat</a>){ <span class="comment">// print ranks for B after 1st trsm</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descBrk, Brk_initial, 1, <span class="keywordtype">double</span>, NT, NTB );</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordflow">if</span>(MORSE_My_Mpi_Rank()==0){</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <a class="code" href="structhicma__stat__s.html">HICMA_stat_t</a> hicma_statrk_initial;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            zget_stat(MorseUpperLower, Brk_initial, NT, NTB, NT,  &amp;hicma_statrk_initial);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            printf(<span class="stringliteral">&quot;------------------------------B ranks after 1st trsm:&quot;</span>);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            zprint_stat(hicma_statrk_initial);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            fflush(stderr);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            fflush(stdout);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    gettimeofday (&amp;tvalBefore, NULL);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span>(1)<a class="code" href="ztrsm_8c.html#a2f3bc32948dc5295b53bc442465956ac">HICMA_ztrsm_Tile</a>(MorseLeft, <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, trans2, MorseNonUnit, 1.0, </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            descAUV, </div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            descAD, </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            descArk,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            descBUV, </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            descBrk, </div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            fixedrank, comp_maxrank, fixedacc);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    gettimeofday (&amp;tvalAfter, NULL);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">double</span> ttrsm2 = (tvalAfter.tv_sec - tvalBefore.tv_sec)</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                 +(tvalAfter.tv_usec - tvalBefore.tv_usec)/1000000.0;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#aa6e67ccd4b03d37bcc8a0dd2550252b4">calc_rank_stat</a>){ <span class="comment">// print initial ranks</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descBrk, Brk_initial, 1, <span class="keywordtype">double</span>, NT, NTB );</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span>(MORSE_My_Mpi_Rank()==0){</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <a class="code" href="structhicma__stat__s.html">HICMA_stat_t</a> hicma_statrk_initial;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            zget_stat(MorseUpperLower, Brk_initial, NT, 1, NT,  &amp;hicma_statrk_initial);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            printf(<span class="stringliteral">&quot;------------------------------B ranks after 2nd trsm:&quot;</span>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            zprint_stat(hicma_statrk_initial);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            fflush(stderr);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            fflush(stdout);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span>(MORSE_My_Mpi_Rank()==0){</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        printf(<span class="stringliteral">&quot;%d %d %d %d %d %d %d %d %d %.1e %d %d &quot;</span>, P*Q, P, Q, N, NRHS, LDA, LDB, NB, fixedrank, fixedacc, maxrank, comp_maxrank);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        printf(<span class="stringliteral">&quot;%g %g %g %g %g %g\n&quot;</span>, tgad, tgauv, tgbuv, tpotrf, ttrsm1, ttrsm2);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        fflush(stderr);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        fflush(stdout);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">//printf(&quot;%s %d %s EXITING %e\n&quot;, __FILE__, __LINE__, __func__, fixedacc);exit(0);</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        HICMA_zuncompress_custom_size(MorseUpperLower, descBUV, descBdense, descBrk, N, NRHS, NB, NB); </div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <a class="code" href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a>( descBdense, Bhicma, 1, <span class="keywordtype">double</span>, LDA, NRHS );</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        info_solution = check_solution(N, NRHS, Aorg, LDA, Borg, Bhicma, LDB, fixedacc);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">/* Check the factorization and the solution */</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">//info_factorization = check_factorization( N, A1, A2, LDA, uplo, eps);</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        info_solution = check_solution(N, NRHS, A1, LDA, B1, B2, LDB, eps);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">if</span> ((info_solution == 0)&amp;(info_factorization == 0)){</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            printf(<span class="stringliteral">&quot;***************************************************\n&quot;</span>);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            printf(<span class="stringliteral">&quot; ---- TESTING ZPOTRF + ZTRSM + ZTRSM ..... PASSED !\n&quot;</span>);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            printf(<span class="stringliteral">&quot;***************************************************\n&quot;</span>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            printf(<span class="stringliteral">&quot;***************************************************\n&quot;</span>);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            printf(<span class="stringliteral">&quot; - TESTING ZPOTRF + ZTRSM + ZTRSM ... FAILED !\n&quot;</span>);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            printf(<span class="stringliteral">&quot;***************************************************\n&quot;</span>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        free(A1); free(A2); free(B1); free(B2);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a>){</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <a class="code" href="timing_8h.html#a9bbfaa0869f40a55f87c49a2c84ae59b">PASTE_CODE_FREE_MATRIX</a>( descAdense );</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="timing_8h.html#a9bbfaa0869f40a55f87c49a2c84ae59b">PASTE_CODE_FREE_MATRIX</a>( descBdense );</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="timing_8h.html#a9bbfaa0869f40a55f87c49a2c84ae59b">PASTE_CODE_FREE_MATRIX</a>( descAD );</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="timing_8h.html#a9bbfaa0869f40a55f87c49a2c84ae59b">PASTE_CODE_FREE_MATRIX</a>( descAUV );</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="timing_8h.html#a9bbfaa0869f40a55f87c49a2c84ae59b">PASTE_CODE_FREE_MATRIX</a>( descArk );</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="timing_8h.html#a9bbfaa0869f40a55f87c49a2c84ae59b">PASTE_CODE_FREE_MATRIX</a>( descBUV );</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="timing_8h.html#a9bbfaa0869f40a55f87c49a2c84ae59b">PASTE_CODE_FREE_MATRIX</a>( descBrk );</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">return</span> hres;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;}</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">/*------------------------------------------------------------------------</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"> *  Check the factorization of the matrix A2</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> check_factorization(<span class="keywordtype">int</span> N, <span class="keywordtype">double</span> *A1, <span class="keywordtype">double</span> *A2, <span class="keywordtype">int</span> LDA, <span class="keywordtype">int</span> <a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a>, <span class="keywordtype">double</span> eps)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;{</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordtype">double</span> Anorm, Rnorm;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordtype">double</span> alpha;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordtype">int</span> info_factorization;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordtype">int</span> i,j;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordtype">double</span> *Residual = (<span class="keywordtype">double</span> *)malloc(N*N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordtype">double</span> *L1       = (<span class="keywordtype">double</span> *)malloc(N*N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordtype">double</span> *L2       = (<span class="keywordtype">double</span> *)malloc(N*N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordtype">double</span> *work              = (<span class="keywordtype">double</span> *)malloc(N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    memset((<span class="keywordtype">void</span>*)L1, 0, N*N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    memset((<span class="keywordtype">void</span>*)L2, 0, N*N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    alpha= 1.0;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    LAPACKE_dlacpy_work(LAPACK_COL_MAJOR,<span class="charliteral">&#39; &#39;</span>, N, N, A1, LDA, Residual, N);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">/* Dealing with L&#39;L or U&#39;U  */</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a> == MorseUpper){</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        LAPACKE_dlacpy_work(LAPACK_COL_MAJOR,<span class="charliteral">&#39;u&#39;</span>, N, N, A2, LDA, L1, N);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        LAPACKE_dlacpy_work(LAPACK_COL_MAJOR,<span class="charliteral">&#39;u&#39;</span>, N, N, A2, LDA, L2, N);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        cblas_dtrmm(CblasColMajor, CblasLeft, CblasUpper, CblasTrans, CblasNonUnit, N, N, (alpha), L1, N, L2, N);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        LAPACKE_dlacpy_work(LAPACK_COL_MAJOR,<span class="charliteral">&#39;l&#39;</span>, N, N, A2, LDA, L1, N);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        LAPACKE_dlacpy_work(LAPACK_COL_MAJOR,<span class="charliteral">&#39;l&#39;</span>, N, N, A2, LDA, L2, N);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        cblas_dtrmm(CblasColMajor, CblasRight, CblasLower, CblasTrans, CblasNonUnit, N, N, (alpha), L1, N, L2, N);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">/* Compute the Residual || A -L&#39;L|| */</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; N; i++)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; N; j++)</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;           Residual[j*N+i] = L2[j*N+i] - Residual[j*N+i];</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    BLAS_dge_norm( <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a>, <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a>, N, N, Residual, N, &amp;Rnorm );</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    BLAS_dge_norm( <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a>, <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a>, N, N, A1, LDA, &amp;Anorm );</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    printf(<span class="stringliteral">&quot;============\n&quot;</span>);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    printf(<span class="stringliteral">&quot;Checking the Cholesky Factorization \n&quot;</span>);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    printf(<span class="stringliteral">&quot;-- ||L&#39;L-A||_oo/(||A||_oo.N.eps) = %e eps:%.1e\n&quot;</span>,Rnorm/(Anorm*N*eps), eps);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span> ( isnan(Rnorm/(Anorm*N*eps)) || isinf(Rnorm/(Anorm*N*eps)) || (Rnorm/(Anorm*N*eps) &gt; 60.0) ){</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        printf(<span class="stringliteral">&quot;-- Factorization is suspicious ! \n&quot;</span>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        info_factorization = 1;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        printf(<span class="stringliteral">&quot;-- Factorization is CORRECT ! \n&quot;</span>);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        info_factorization = 0;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    free(Residual); free(L1); free(L2); free(work);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">return</span> info_factorization;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;}</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">/*------------------------------------------------------------------------</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"> *  Check the accuracy of the solution of the linear system</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> check_solution(<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> NRHS, <span class="keywordtype">double</span> *A1, <span class="keywordtype">int</span> LDA, <span class="keywordtype">double</span> *B1, <span class="keywordtype">double</span> *B2, <span class="keywordtype">int</span> LDB, <span class="keywordtype">double</span> eps )</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;{</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">int</span> info_solution;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordtype">double</span> Rnorm, Anorm, Xnorm, Bnorm, result;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">double</span> alpha, beta;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordtype">double</span> *work = (<span class="keywordtype">double</span> *)malloc(N*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    alpha = 1.0;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    beta  = -1.0;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    BLAS_dge_norm( <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a>, <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a>, N, NRHS, B2, LDB, &amp;Xnorm );</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    BLAS_dge_norm( <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a>, <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a>, N, N,    A1, LDA, &amp;Anorm );</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    BLAS_dge_norm( <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a>, <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a>, N, NRHS, B1, LDB, &amp;Bnorm );</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    cblas_dgemm(CblasColMajor, CblasNoTrans, CblasNoTrans, N, NRHS, N, (alpha), A1, LDA, B2, LDB, (beta), B1, LDB);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    BLAS_dge_norm( <a class="code" href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a>, <a class="code" href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a>, N, NRHS, B1, LDB, &amp;Rnorm );</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (getenv(<span class="stringliteral">&quot;MORSE_TESTING_VERBOSE&quot;</span>)) {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      printf( <span class="stringliteral">&quot;||A||_oo=%f\n||X||_oo=%f\n||B||_oo=%f\n||A X - B||_oo=%e eps:%.2e\n&quot;</span>, Anorm, Xnorm, Bnorm, Rnorm, eps );</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    result = Rnorm / ( (Anorm*Xnorm+Bnorm)*N*eps ) ;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    printf(<span class="stringliteral">&quot;============\n&quot;</span>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    printf(<span class="stringliteral">&quot;Checking the Residual of the solution \n&quot;</span>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    printf(<span class="stringliteral">&quot;-- ||Ax-B||_oo/((||A||_oo||x||_oo+||B||_oo).N.eps) = %e \n&quot;</span>, result);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">if</span> (  isnan(Xnorm) || isinf(Xnorm) || isnan(result) || isinf(result) || (result &gt; 60.0) ) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        printf(<span class="stringliteral">&quot;-- The solution is suspicious ! \n&quot;</span>);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        info_solution = 1;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;     }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        printf(<span class="stringliteral">&quot;-- The solution is CORRECT ! \n&quot;</span>);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        info_solution = 0;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    free(work);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">return</span> info_solution;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;}</div><div class="ttc" id="testing__zposv_8c_html_a9e6ec9e515f9d9b7e47110ae5f6ea04ea635ab08ac28ae417e25c0d163c40f19d"><div class="ttname"><a href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea635ab08ac28ae417e25c0d163c40f19d">blas_rowmajor</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00091">testing_zposv.c:91</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a9e6ec9e515f9d9b7e47110ae5f6ea04e"><div class="ttname"><a href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04e">blas_order_type</a></div><div class="ttdeci">blas_order_type</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00090">testing_zposv.c:90</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952ba607f3142e766379f65fecd8964e9a8ed"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba607f3142e766379f65fecd8964e9a8ed">blas_frobenius_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00111">testing_zposv.c:111</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952b"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952b">blas_norm_type</a></div><div class="ttdeci">blas_norm_type</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00107">testing_zposv.c:107</a></div></div>
<div class="ttc" id="testing__zauxiliary_8h_html_a62447c1589cbae34e393d90ef58fbae0"><div class="ttname"><a href="testing__zauxiliary_8h.html#a62447c1589cbae34e393d90ef58fbae0">USAGE</a></div><div class="ttdeci">#define USAGE(name, args, details)</div><div class="ttdef"><b>Definition:</b> <a href="testing__zauxiliary_8h_source.html#l00031">testing_zauxiliary.h:31</a></div></div>
<div class="ttc" id="hicma__struct_8h_html"><div class="ttname"><a href="hicma__struct_8h.html">hicma_struct.h</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_aa85c9eab3bb20fb73495fb9d1928ba82"><div class="ttname"><a href="testing__zposv_8c.html#aa85c9eab3bb20fb73495fb9d1928ba82">tm_info</a></div><div class="ttdeci">struct tm * tm_info</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00059">testing_zposv.c:59</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa450c812108b1c81a0f6ef65c51f64d7b"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa450c812108b1c81a0f6ef65c51f64d7b">blas_base</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00095">testing_zposv.c:95</a></div></div>
<div class="ttc" id="structhicma__problem__s_html_a8d78cccef2bdf229604009ebcea0af55"><div class="ttname"><a href="structhicma__problem__s.html#a8d78cccef2bdf229604009ebcea0af55">hicma_problem_s::noise</a></div><div class="ttdeci">double noise</div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00028">hicma_struct.h:28</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_ac7db2505fed4fcb84e94a6225ba1fe4a"><div class="ttname"><a href="testing__zposv_8c.html#ac7db2505fed4fcb84e94a6225ba1fe4a">print_index_end</a></div><div class="ttdeci">int print_index_end</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00071">testing_zposv.c:71</a></div></div>
<div class="ttc" id="testing__zauxiliary_8c_html_ae211b83247d41c3a457052ed883e3e1c"><div class="ttname"><a href="testing__zauxiliary_8c.html#ae211b83247d41c3a457052ed883e3e1c">norm</a></div><div class="ttdeci">int norm[4]</div><div class="ttdef"><b>Definition:</b> <a href="testing__zauxiliary_8c_source.html#l00052">testing_zauxiliary.c:52</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_aa6297329aab26a48806350a4b8fcb0c1"><div class="ttname"><a href="testing__zposv_8c.html#aa6297329aab26a48806350a4b8fcb0c1">global_check</a></div><div class="ttdeci">int global_check</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00062">testing_zposv.c:62</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa4159c63ae4ee2275d8e09d02ecb85428"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa4159c63ae4ee2275d8e09d02ecb85428">blas_underflow</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00103">testing_zposv.c:103</a></div></div>
<div class="ttc" id="timing_8h_html_a92c80b3945c2c00db3c1bf5552a7ee90"><div class="ttname"><a href="timing_8h.html#a92c80b3945c2c00db3c1bf5552a7ee90">PASTE_TILE_TO_LAPACK</a></div><div class="ttdeci">#define PASTE_TILE_TO_LAPACK(_desc_, _name_, _cond_, _type_, _lda_, _n_)</div><div class="ttdef"><b>Definition:</b> <a href="timing_8h_source.html#l00168">timing.h:168</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a44c4b4ac7cd71c503b133733604ad3ad"><div class="ttname"><a href="testing__zposv_8c.html#a44c4b4ac7cd71c503b133733604ad3ad">mpiF</a></div><div class="ttdeci">STARSH_blrf * mpiF</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00055">testing_zposv.c:55</a></div></div>
<div class="ttc" id="structhicma__problem__s_html"><div class="ttname"><a href="structhicma__problem__s.html">hicma_problem_s</a></div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00021">hicma_struct.h:21</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa640085acde3bcb1c78c42e9b5838c714"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa640085acde3bcb1c78c42e9b5838c714">blas_ieee</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00098">testing_zposv.c:98</a></div></div>
<div class="ttc" id="hicma__z_8h_html"><div class="ttname"><a href="hicma__z_8h.html">hicma_z.h</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a657cb599f5adb6ac9b0fe93c811417cf"><div class="ttname"><a href="testing__zposv_8c.html#a657cb599f5adb6ac9b0fe93c811417cf">print_mat</a></div><div class="ttdeci">int print_mat</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00073">testing_zposv.c:73</a></div></div>
<div class="ttc" id="timing_8h_html_a9bbfaa0869f40a55f87c49a2c84ae59b"><div class="ttname"><a href="timing_8h.html#a9bbfaa0869f40a55f87c49a2c84ae59b">PASTE_CODE_FREE_MATRIX</a></div><div class="ttdeci">#define PASTE_CODE_FREE_MATRIX(_desc_)</div><div class="ttdef"><b>Definition:</b> <a href="timing_8h_source.html#l00165">timing.h:165</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaaadf329e788494c80e522348ef1210d9f"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaaadf329e788494c80e522348ef1210d9f">blas_prec</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00102">testing_zposv.c:102</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a9f5eb02dc0de8dfb68423b6bf1584d4f"><div class="ttname"><a href="testing__zposv_8c.html#a9f5eb02dc0de8dfb68423b6bf1584d4f">global_omit_computation</a></div><div class="ttdeci">int global_omit_computation</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00065">testing_zposv.c:65</a></div></div>
<div class="ttc" id="structhicma__problem__s_html_a28b0fc4cfeed43d574b4a509bbb677ec"><div class="ttname"><a href="structhicma__problem__s.html#a28b0fc4cfeed43d574b4a509bbb677ec">hicma_problem_s::beta</a></div><div class="ttdeci">double beta</div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00026">hicma_struct.h:26</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_ae303075f66206b33ae8872b02a156749"><div class="ttname"><a href="testing__zposv_8c.html#ae303075f66206b33ae8872b02a156749">datebuf</a></div><div class="ttdeci">char datebuf[128]</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00057">testing_zposv.c:57</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a8d256ee0e918b448d34a31918dedbd83"><div class="ttname"><a href="testing__zposv_8c.html#a8d256ee0e918b448d34a31918dedbd83">main_print_mat</a></div><div class="ttdeci">int main_print_mat</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00072">testing_zposv.c:72</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_ae2281da6157495d69406c35f69a61f9f"><div class="ttname"><a href="testing__zposv_8c.html#ae2281da6157495d69406c35f69a61f9f">timer</a></div><div class="ttdeci">time_t timer</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00058">testing_zposv.c:58</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952ba1ff3a55280960c17e59d37500ab4eec5"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba1ff3a55280960c17e59d37500ab4eec5">blas_real_inf_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00113">testing_zposv.c:113</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a43a9b9179b6dbe0abf84e1a4545f9ff0"><div class="ttname"><a href="testing__zposv_8c.html#a43a9b9179b6dbe0abf84e1a4545f9ff0">use_scratch</a></div><div class="ttdeci">int use_scratch</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00074">testing_zposv.c:74</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e"><div class="ttname"><a href="testing__zposv_8c.html#a9e6ec9e515f9d9b7e47110ae5f6ea04ea69ab6bcac9a135e7321dc4ca72616d1e">blas_colmajor</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00092">testing_zposv.c:92</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a9a02d72544ae226c3517f7bcfd6d8cfb"><div class="ttname"><a href="testing__zposv_8c.html#a9a02d72544ae226c3517f7bcfd6d8cfb">global_fixed_rank</a></div><div class="ttdeci">int global_fixed_rank</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00064">testing_zposv.c:64</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952ba57c558d28842a2b7b90df3a796fde77e"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba57c558d28842a2b7b90df3a796fde77e">blas_two_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00110">testing_zposv.c:110</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952bae48280621b0adfec78d7a180c1026953"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bae48280621b0adfec78d7a180c1026953">blas_real_max_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00115">testing_zposv.c:115</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_abdeec1578acd87ea1bd3331fc790184f"><div class="ttname"><a href="testing__zposv_8c.html#abdeec1578acd87ea1bd3331fc790184f">store_only_diagonal_tiles</a></div><div class="ttdeci">int store_only_diagonal_tiles</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00061">testing_zposv.c:61</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a7b03aa5d40a76877504a546ca74e7e5e"><div class="ttname"><a href="testing__zposv_8c.html#a7b03aa5d40a76877504a546ca74e7e5e">diag_nrows</a></div><div class="ttdeci">int diag_nrows</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00068">testing_zposv.c:68</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952ba6a806e7014a17f2b175780210e43d0cf"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba6a806e7014a17f2b175780210e43d0cf">blas_max_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00114">testing_zposv.c:114</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa16a1c297dab1551cf40bbe5210395f10"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa16a1c297dab1551cf40bbe5210395f10">blas_t</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00096">testing_zposv.c:96</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a5aa1731610537e057191db627c19f1ca"><div class="ttname"><a href="testing__zposv_8c.html#a5aa1731610537e057191db627c19f1ca">check</a></div><div class="ttdeci">int check</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00076">testing_zposv.c:76</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_ac917522ad05f6f21b5cc38fe99ab4de7"><div class="ttname"><a href="testing__zposv_8c.html#ac917522ad05f6f21b5cc38fe99ab4de7">main_print_index</a></div><div class="ttdeci">int main_print_index</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00069">testing_zposv.c:69</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaad93796f5d1a8bc7bb4d9512dc312e8df"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaad93796f5d1a8bc7bb4d9512dc312e8df">blas_emin</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00099">testing_zposv.c:99</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a28d31db4990daf0197cb0ac24c95ccd5"><div class="ttname"><a href="testing__zposv_8c.html#a28d31db4990daf0197cb0ac24c95ccd5">testing_dposv</a></div><div class="ttdeci">int testing_dposv(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00228">testing_zposv.c:228</a></div></div>
<div class="ttc" id="hicma__init_8c_html_aaa82fe254c96bfd780cb79ed033cff0f"><div class="ttname"><a href="hicma__init_8c.html#aaa82fe254c96bfd780cb79ed033cff0f">HICMA_init</a></div><div class="ttdeci">int HICMA_init()</div><div class="ttdef"><b>Definition:</b> <a href="hicma__init_8c_source.html#l00002">hicma_init.c:2</a></div></div>
<div class="ttc" id="structhicma__problem__s_html_a39732d3763d08c55546b52cd143a04d5"><div class="ttname"><a href="structhicma__problem__s.html#a39732d3763d08c55546b52cd143a04d5">hicma_problem_s::starsh_format</a></div><div class="ttdeci">STARSH_blrf * starsh_format</div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00022">hicma_struct.h:22</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952ba6f826b18a3a197b97b228961fdab47b3"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952ba6f826b18a3a197b97b228961fdab47b3">blas_real_one_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00109">testing_zposv.c:109</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_aeb23e3045f3c24373c05b3fa07ea56ec"><div class="ttname"><a href="testing__zposv_8c.html#aeb23e3045f3c24373c05b3fa07ea56ec">num_mpi_ranks</a></div><div class="ttdeci">int num_mpi_ranks</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00066">testing_zposv.c:66</a></div></div>
<div class="ttc" id="structhicma__problem__s_html_a277a26c7aa8ea35fd91e8380a4975276"><div class="ttname"><a href="structhicma__problem__s.html#a277a26c7aa8ea35fd91e8380a4975276">hicma_problem_s::ndim</a></div><div class="ttdeci">int ndim</div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00024">hicma_struct.h:24</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa51424a153ba5a72b4fb5018732bbaa02"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa51424a153ba5a72b4fb5018732bbaa02">blas_overflow</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00104">testing_zposv.c:104</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa26e73a26ce9e06149fff858bdfb5f363"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa26e73a26ce9e06149fff858bdfb5f363">blas_emax</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00100">testing_zposv.c:100</a></div></div>
<div class="ttc" id="hicma__constants_8h_html_a0ac6248f461a4a6216198380ae040de4"><div class="ttname"><a href="hicma__constants_8h.html#a0ac6248f461a4a6216198380ae040de4">HICMA_STARSH_PROB_SS</a></div><div class="ttdeci">#define HICMA_STARSH_PROB_SS</div><div class="ttdef"><b>Definition:</b> <a href="hicma__constants_8h_source.html#l00023">hicma_constants.h:23</a></div></div>
<div class="ttc" id="zhagdm_8c_html_a8ca1f21ad6ed9a1efaa328076be8f383"><div class="ttname"><a href="zhagdm_8c.html#a8ca1f21ad6ed9a1efaa328076be8f383">HICMA_zhagdm_Tile</a></div><div class="ttdeci">int HICMA_zhagdm_Tile(MORSE_enum uplo, MORSE_desc_t *Dense)</div><div class="ttdef"><b>Definition:</b> <a href="zhagdm_8c_source.html#l00057">zhagdm.c:57</a></div></div>
<div class="ttc" id="zhagdm_8c_html_af7fb9e553cc44d524879590bca083e3a"><div class="ttname"><a href="zhagdm_8c.html#af7fb9e553cc44d524879590bca083e3a">HICMA_zhagdmdiag_Tile</a></div><div class="ttdeci">int HICMA_zhagdmdiag_Tile(MORSE_enum uplo, MORSE_desc_t *Dense)</div><div class="ttdef"><b>Definition:</b> <a href="zhagdm_8c_source.html#l00162">zhagdm.c:162</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952bab661151b14ab3c58c0b3d335528db250"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab661151b14ab3c58c0b3d335528db250">blas_one_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00108">testing_zposv.c:108</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a0511e461ff0eecd8438a9396907a6cf7"><div class="ttname"><a href="testing__zposv_8c.html#a0511e461ff0eecd8438a9396907a6cf7">global_always_fixed_rank</a></div><div class="ttdeci">int global_always_fixed_rank</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00063">testing_zposv.c:63</a></div></div>
<div class="ttc" id="structhicma__problem__s_html_a069c64f1bdeb11b98c64cefb9c3c2f8b"><div class="ttname"><a href="structhicma__problem__s.html#a069c64f1bdeb11b98c64cefb9c3c2f8b">hicma_problem_s::nu</a></div><div class="ttdeci">double nu</div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00027">hicma_struct.h:27</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a8425a9dfb0b29dd7a3b1ec27bb670b7b"><div class="ttname"><a href="testing__zposv_8c.html#a8425a9dfb0b29dd7a3b1ec27bb670b7b">testing_dtrsmd</a></div><div class="ttdeci">int testing_dtrsmd(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00215">testing_zposv.c:215</a></div></div>
<div class="ttc" id="structhicma__problem__s_html_a8f3435c8c683d2a95517ae7213d3b9f1"><div class="ttname"><a href="structhicma__problem__s.html#a8f3435c8c683d2a95517ae7213d3b9f1">hicma_problem_s::wave_k</a></div><div class="ttdeci">double wave_k</div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00032">hicma_struct.h:32</a></div></div>
<div class="ttc" id="ztrsm_8c_html_a2f3bc32948dc5295b53bc442465956ac"><div class="ttname"><a href="ztrsm_8c.html#a2f3bc32948dc5295b53bc442465956ac">HICMA_ztrsm_Tile</a></div><div class="ttdeci">int HICMA_ztrsm_Tile(MORSE_enum side, MORSE_enum uplo, MORSE_enum transA, MORSE_enum diag, double alpha, MORSE_desc_t *AUV, MORSE_desc_t *AD, MORSE_desc_t *Ark, MORSE_desc_t *BUV, MORSE_desc_t *Brk, int rk, int maxrk, double acc)</div><div class="ttdef"><b>Definition:</b> <a href="ztrsm_8c_source.html#l00104">ztrsm.c:104</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa0a3cdfdc2ddd9ce036017d4c57aa941a"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa0a3cdfdc2ddd9ce036017d4c57aa941a">blas_sfmin</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00105">testing_zposv.c:105</a></div></div>
<div class="ttc" id="zpotrf_8c_html_a8d8da3e5c0f95aa5c8887d96268d9ffa"><div class="ttname"><a href="zpotrf_8c.html#a8d8da3e5c0f95aa5c8887d96268d9ffa">HICMA_zpotrf_Tile</a></div><div class="ttdeci">int HICMA_zpotrf_Tile(MORSE_enum uplo, MORSE_desc_t *AUV, MORSE_desc_t *AD, MORSE_desc_t *Ark, int rk, int maxrk, double acc)</div><div class="ttdef"><b>Definition:</b> <a href="zpotrf_8c_source.html#l00079">zpotrf.c:79</a></div></div>
<div class="ttc" id="hicma__constants_8h_html"><div class="ttname"><a href="hicma__constants_8h.html">hicma_constants.h</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a0db6b4e1bb0df6828e8db32f80fe5188"><div class="ttname"><a href="testing__zposv_8c.html#a0db6b4e1bb0df6828e8db32f80fe5188">run_potrf</a></div><div class="ttdeci">int run_potrf</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00067">testing_zposv.c:67</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c"><div class="ttname"><a href="testing__zposv_8c.html#a07072da9995d9196d9176f56c784952bab50c138192cb933e81550900a44d187c">blas_inf_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00112">testing_zposv.c:112</a></div></div>
<div class="ttc" id="testing__zauxiliary_8c_html_a3f2b0e5ce8826a750a564f2a277f6603"><div class="ttname"><a href="testing__zauxiliary_8c.html#a3f2b0e5ce8826a750a564f2a277f6603">uplo</a></div><div class="ttdeci">int uplo[2]</div><div class="ttdef"><b>Definition:</b> <a href="testing__zauxiliary_8c_source.html#l00047">testing_zauxiliary.c:47</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_aa6e67ccd4b03d37bcc8a0dd2550252b4"><div class="ttname"><a href="testing__zposv_8c.html#aa6e67ccd4b03d37bcc8a0dd2550252b4">calc_rank_stat</a></div><div class="ttdeci">int calc_rank_stat</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00075">testing_zposv.c:75</a></div></div>
<div class="ttc" id="hicma_8h_html"><div class="ttname"><a href="hicma_8h.html">hicma.h</a></div></div>
<div class="ttc" id="structhicma__problem__s_html_a20f9468f7d97d90af57a34ca8dd31f34"><div class="ttname"><a href="structhicma__problem__s.html#a20f9468f7d97d90af57a34ca8dd31f34">hicma_problem_s::diag</a></div><div class="ttdeci">double diag</div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00029">hicma_struct.h:29</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a93f13d2deb70a9588f4db51c4a4e1cea"><div class="ttname"><a href="testing__zposv_8c.html#a93f13d2deb70a9588f4db51c4a4e1cea">print_index</a></div><div class="ttdeci">int print_index</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00070">testing_zposv.c:70</a></div></div>
<div class="ttc" id="testing__zauxiliary_8h_html"><div class="ttname"><a href="testing__zauxiliary_8h.html">testing_zauxiliary.h</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa3d5fea2fad72607b2368ace39fa89280"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa3d5fea2fad72607b2368ace39fa89280">blas_rnd</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00097">testing_zposv.c:97</a></div></div>
<div class="ttc" id="structhicma__stat__s_html"><div class="ttname"><a href="structhicma__stat__s.html">hicma_stat_s</a></div><div class="ttdef"><b>Definition:</b> <a href="hicma__struct_8h_source.html#l00041">hicma_struct.h:41</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aa"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aa">blas_cmach_type</a></div><div class="ttdeci">blas_cmach_type</div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00094">testing_zposv.c:94</a></div></div>
<div class="ttc" id="testing__zposv_8c_html_a6ef40f4bf16a7f484390a20fdb55d3aaa3e407f69dd9a70e04e91602a3d76ae4a"><div class="ttname"><a href="testing__zposv_8c.html#a6ef40f4bf16a7f484390a20fdb55d3aaa3e407f69dd9a70e04e91602a3d76ae4a">blas_eps</a></div><div class="ttdef"><b>Definition:</b> <a href="testing__zposv_8c_source.html#l00101">testing_zposv.c:101</a></div></div>
<div class="ttc" id="timing_8h_html"><div class="ttname"><a href="timing_8h.html">timing.h</a></div></div>
<div class="ttc" id="zhagcm_8c_html_acb781bd1e4c1392280b0b31b3a5b8364"><div class="ttname"><a href="zhagcm_8c.html#acb781bd1e4c1392280b0b31b3a5b8364">HICMA_zhagcm_Tile</a></div><div class="ttdeci">int HICMA_zhagcm_Tile(MORSE_enum uplo, MORSE_desc_t *AUV, MORSE_desc_t *Ark, int numrows_matrix, int numcols_matrix, int numrows_block, int numcols_block, int maxrank, double tol)</div><div class="ttdef"><b>Definition:</b> <a href="zhagcm_8c_source.html#l00092">zhagcm.c:92</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_64f94c193e4d03baf6e89b1053934749.html">testing</a></li><li class="navelem"><a class="el" href="testing__zposv_8c.html">testing_zposv.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
